
<https://www.ipa.go.jp/security/crypto/guideline/gmcbt80000005ua7-att/000090943.pdf>

「機密指定されていないけれど重要な情報」とは、国家機密ほどの厳重な保護が必要ではないものの、漏洩すると個人や組織にとって大きなリスクをもたらす情報

NIST（米国標準技術研究所）は、機密ではないけれど重要な情報を守るために、次の2種類の文書を発行しています：

 1. 連邦情報処理標準（FIPS）：連邦政府が必ず従わなければならない暗号技術の公式な基準。
 2. NIST推奨（特別刊行物：SP）：政府以外の組織や個人も参考にできるセキュリティ対策のガイドライン。

要するに、NISTの文書で使われる「しなければならない（shall）」と「すべきである（should）」は、それぞれ重要度の異なる指示を示しています：

 1. しなければならない（shall）

- 必須の要求事項を意味し、FIPSや推奨への適合を主張するには絶対に守る必要がある。
- 「してはならない（shall not）」の場合は、厳しく禁止されていることを意味する。

 2. すべきである（should）

- 重要な推奨事項を意味し、守ることが望ましい。無視すると悪い結果を招く可能性がある。
- 「すべきでない（should not）」の場合は、避けるべきことを意味する。

つまり、「shall」は絶対必須、「should」は強く推奨というニュアンスの違いがあります。

## 暗号技術で提供・サポート可能なセキュリティサービス  

- 機密性  
  - 情報が不正な者に開示されない特性  
  - 適切な暗号化と復号鍵管理により、権限ある者のみが平文を取得可能  
  - 暗号アルゴリズムや利用モードは、権限なき者が復号鍵を推定・取得不可能な設計が必要  
- データ完全性  
  - データが不正に改変（挿入・削除・置換など）されていないことを示す特性  
  - メッセージ認証コード(MAC)やデジタル署名により、偶発的・意図的な改ざん検出が可能  
  - 「データ完全性を提供」とは、認可なき改変を検出できることを意味  
- 認証  
  - ID認証  
    - やり取りするエンティティのIDが正当であることを確認  
    - この確立が成功すると、サービスやリソースへのアクセス制御につなげやすい  
  - 完全性認証  
    - データが改変されていないことを暗号的手段で確認  
    - デジタル署名やMACにより実現  
  - ソース認証  
    - 情報を作成・送信した実体（発信者）の真正性を確認  
    - メッセージ発信者の特定や責任の所在明確化に有用
- 認可  
  - 機能やリソース（文書・部屋など）へのアクセス制御（許可・制限）  
  - 一般にID認証成功後に認可が付与される  
  - ID確認後、必要なアクセス手段（鍵・パスワード）を許可対象に提供し、特定リソース利用を可能にする
- 否認防止  
  - デジタル署名鍵と証明書によって公開鍵と主体名を結びつけ、署名者の行為否認を困難にする  
  - 完全性認証・ソース認証に加え、書面上の署名と同様の法的意味（契約上のコミットメントなど）を示すことが可能  
  - 法的判断が最終的な決定要素であり、暗号はあくまでその判断をサポートする一要素にとどまる

### PKI の流れ

・PKIは、安全な通信や信頼性の確保を目的とし、デジタル証明書を発行・管理する仕組み  
・PKIの要素として、証明書を発行して信頼性を保証するCA、申請者の身元を確認するRAがある  
・証明書申請者はRAで身元確認（運転免許証やパスポートなど）を行う

(1) 鍵ペアの作成  
・申請者はRSAやECDSAなどのアルゴリズムで秘密鍵と公開鍵を生成  
・秘密鍵は申請者のみが管理し、公開鍵は他者と共有できる

(2) 証明書の発行  
・申請者は公開鍵をRAとCAへ送付  
・RAが身元確認後、CAは公開鍵と申請者情報を組み合わせて証明書を発行  
・証明書にはCAの秘密鍵での署名があり、それにより証明書の信頼性が保証される  
・秘密鍵は決して他人に渡さない

(3) 証明書とデータのやり取り  
・署名者は秘密鍵でデータのハッシュ値を暗号化し署名を作成  
・署名と元データ、証明書を受信者に送る  
・受信者はCAの公開鍵で証明書を検証し、署名者の公開鍵で署名を検証する  
・ハッシュ値が一致すれば改ざんがなく、署名者本人がデータを送ったことが確認可能

(4) 公開鍵暗号の基本概念  
・秘密鍵は本人のみが保持  
・公開鍵は誰でも利用可能  
・秘密鍵で処理したデータは対応する公開鍵でのみ検証可能  
・この関係により、第三者が署名を確認できる

(5) デジタル署名の手順  
・ハッシュ関数でデータを要約  
・要約結果を秘密鍵で暗号化し署名を作成  
・受信側は同じハッシュ関数でデータを要約し、公開鍵で署名を復号した結果と比較  
・一致すれば、データが改ざんされず、署名者本人による署名であることがわかる

(6) 公開鍵で検証可能な理由  
・秘密鍵で暗号化されたものは対応する公開鍵でのみ復号可能  
・公開鍵が広く共有されることで署名者の信頼が担保される

(7) ハッシュ値不一致時  
・データ改ざんや不正な署名が疑われる  
・秘密鍵を持たない第三者による偽装の可能性がある

## 暗号アルゴリズム
